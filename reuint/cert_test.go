package reuint

import (
	"fmt"
	"testing"
)

func TestParseCert(t *testing.T) {
	dataPem := `LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUNBakNDQWFlZ0F3SUJBZ0lJQXM2M3g2N1BaNzR3Q2dZSUtvRWN6MVVCZzNVd1FqRUxNQWtHQTFVRUJoTUMKUTA0eER6QU5CZ05WQkFnTUJ1YTFtZWF4bnpFUE1BMEdBMVVFQnd3RzVwMnQ1YmVlTVJFd0R3WURWUVFLREFqbQp0WXZvcjVWRFFUQWVGdzB5TXpBeE1UQXdOek0zTkRWYUZ3MHlOREF4TVRBd056TTNORFZhTUdreER6QU5CZ05WCkJBWU1CdVM0cmVXYnZURVBNQTBHQTFVRUNBd0c1cldaNXJHZk1ROHdEUVlEVlFRSERBYm1uYTNsdDU0eER6QU4KQmdOVkJBb01CdWlFaWVpdXJ6RVBNQTBHQTFVRUN3d0c1NkNVNVkrUk1SSXdFQVlEVlFRRERBbDNiSG5tdFl2bwpyNVV3V1RBVEJnY3Foa2pPUFFJQkJnZ3FnUnpQVlFHQ0xRTkNBQVJyeXQvbk9ZeXNVRmdRRWZ4WVpGUVRUcDY5Cjg2YnIrWTVYRDhrb3U2MnllcVFJM1ZidFMxcXluKzgyWkE4dFVJOFBBWlkyTEp2SWJKMmROZzVwT0F0Z28yQXcKWGpBT0JnTlZIUThCQWY4RUJBTUNCc0F3REFZRFZSMFRBUUgvQkFJd0FEQWRCZ05WSFE0RUZnUVU4SXFoYVl0cwp6bWFyWFVueXhoSFA2QXE3aGRZd0h3WURWUjBqQkJnd0ZvQVVOcFBqRk9kRkNmclY3K292RWkzVG9aWTh3cVF3CkNnWUlLb0VjejFVQmczVURTUUF3UmdJaEFNY0tQa09pTTg4YjhoZWY4ZHlPOHdiMGtpeDFMYXVxc1owOUE4WmMKVUFVMUFpRUEyeFdYMURwUE55cDVtVkdqY25LaDZDT2JpOXF5Q0tNbFRlYUgzdWhpTHJvPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCgo=`
	certPem, err := ParseCert(dataPem)
	if err != nil {
		t.Fatal(err)
	}
	fmt.Println(certPem.Issuer)
	fmt.Println(certPem.Subject)

	dataDer := `MIIECzCCA7CgAwIBAgIIdMEAqwMl67owDAYIKoEcz1UBg3UFADBSMQswCQYDVQQGEwJDTjEvMC0GA1UECgwmWmhlamlhbmcgRGlnaXRhbCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkxEjAQBgNVBAMMCVpKQ0EgT0NBMTAeFw0yMzAxMTAwMzM2NDFaFw0yNDAxMTAwMzM2NDFaMEUxCzAJBgNVBAYTAkNOMRowGAYDVQQqDBHmtYvor5UgX+euoeeQhuWRmDEaMBgGA1UEAwwR5rWL6K+VIF/nrqHnkIblkZgwWTATBgcqhkjOPQIBBggqgRzPVQGCLQNCAATgl7Zv7cP/95xDXPPgWaP5AatZdWGqnBCeH8ZqqCxkNKNgVqzMNqt5H1uQ6ESWiq2wo8EmcxeaJHydqipOnwlDo4ICeTCCAnUwDAYDVR0TBAUwAwEBADAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwQwDgYDVR0PAQH/BAQDAgDAMGoGA1UdIARjMGEwXwYJKoEchu89AQEBMFIwUAYIKwYBBQUHAgEWRGh0dHBzOi8vd3d3LnpqY2EuY29tLmNuL3dlYi93ZWJzL2Rvd25sb2Fkcy9vdGhlci9DUCZDUFMvWkpDQV9jcDEucGRmMBEGCWCGSAGG+EIBAQQEAwIAgDAeBggqgRzQFAQBAQQSMzMwMTEwMTk5NTA3MDE1NTc0MB8GA1UdIwQYMBaAFKfTsSSQIB09tFTuSzcoUpGuLGoiMIGxBgNVHR8EgakwgaYwgaOggaCggZ2GgZpsZGFwOi8vbGRhcC56amNhLmNvbS5jbi9DTj1aSkNBIE9DQTFncm91cDUyODEsQ049WkpDQSBPQ0ExLCBPVT1DUkxEaXN0cmlidXRlUG9pbnRzLCBvPXpqY2E/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdGNsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MIGiBggrBgEFBQcBAQSBlTCBkjCBjwYIKwYBBQUHMAKGgYJsZGFwOi8vbGRhcC56amNhLmNvbS5jbi9DTj1aSkNBIE9DQTEsQ049WkpDQSBPQ0ExLCBPVT1jQUNlcnRpZmljYXRlcywgbz16amNhP2NBQ2VydGlmaWNhdGU/YmFzZT9vYmplY3RDbGFzcz1jZXJ0aWZpY2F0aW9uQXV0aG9yaXR5MB0GA1UdDgQWBBQVY4z14LOEuCM9kE0uTrtH+0VyRzAMBggqgRzPVQGDdQUAA0cAMEQCIB8R90D5/y1YIGAjkZ/GJDf90b8iJi19qm0Z5Ynm9O4YAiB8Q3zzRdMksVE710XHRIw+rFF3L1grpyXjh2HWbaCagA==`
	certDer, err := ParseCert(dataDer)
	if err != nil {
		t.Fatal(err)
	}
	fmt.Println(certDer.Issuer)
	fmt.Println(certDer.Subject)
}
