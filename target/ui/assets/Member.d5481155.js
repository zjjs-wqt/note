import{_ as se,r as d,o as oe,D as ne,c as r,e as o,d as t,f as u,H as L,u as k,x as re,w as j,F as I,B as C,C as ue,b as _,j as c,k as p,l as de,m as s,A as F,y as V,g as q,I as A,aP as ie,p as ce,q as pe,aO as me}from"./index.4e24e414.js";import{i as ve}from"./icon.43ea7822.js";const B=y=>(ce("data-v-7995702b"),y=y(),pe(),y),_e={key:0},he={key:0},ge={class:"mem-invite"},fe=B(()=>o("div",{style:{float:"left","margin-right":"500px","font-size":"24px","margin-left":"8px"}},[o("strong",null,"\u7528\u6237\u7EC4\u6210\u5458")],-1)),ye=B(()=>o("div",{style:{"font-size":"12px",width:"160px"}},[o("span",null,"\u60A8\u53EF\u4EE5\u9080\u8BF7\u6210\u5458\u52A0\u5165\u7528\u6237\u7EC4\u3002")],-1)),be=B(()=>o("div",{style:{margin:"20px"}},null,-1)),xe={"element-loading-background":"rgba(255, 255, 255, 0.8)","element-loading-text":"\u6570\u636E\u52A0\u8F7D\u4E2D..."},we={style:{height:"45px",display:"flex"}},ke={style:{"margin-top":"5px"}},Ie={class:"mem-list-title",style:{display:"flex"}},Ce=B(()=>o("span",{style:{float:"left","margin-left":"10px"}},[o("strong",null,"\u7528\u6237\u7EC4\u5DF2\u6709\u4EBA\u5458")],-1)),Ve={class:"mem-project",style:{"min-height":"80px"},"element-loading-background":"rgba(255, 255, 255, 0.8)","element-loading-text":"\u6570\u636E\u52A0\u8F7D\u4E2D..."},Be={class:"mem-title-body",style:{display:"flex"}},Me={class:"mem-name",style:{display:"flex"}},Ne={style:{"margin-left":"5px","margin-top":"10px"}},De={key:0,style:{"margin-left":"auto",display:"flex"}},Ge={key:0,class:"mem-search",style:{"margin-right":"10px"}},Ue={key:1,link:"",class:"mem-permission",style:{"padding-right":"10px"}},Se={key:2},ze={key:1,style:{"margin-left":"auto",display:"flex"}},Ee={link:"",class:"mem-permission",style:{"padding-right":"10px"}},Le={__name:"Member",setup(y){const H=d("top"),T=ue(),n=d(0),b=d(!1),O=d(!1),h=d(!1),x=d("");n.value=Number(T.params.id);const M=d({}),i=d({userId:"",role:1,groupId:n.value}),K=["\u7BA1\u7406\u8005","\u7EF4\u62A4","\u666E\u901A\u7528\u6237"],P=[{value:1,label:"\u7EF4\u62A4",disabled:!1},{value:2,label:"\u666E\u901A\u7528\u6237",disabled:!1}],N=d([]);let g="",f="";const R=a=>{if(!a){N.value=[];return}f=a,g===""&&(g=a,b.value=!0,_.get("/api/user/nameList?keyword="+a).then(l=>{N.value=l.data}).then(()=>{if(g===f)return;let l=f;g="",f="",R(l)}).finally(()=>{b.value=!1,g="",f=""}))},D=d(-1),J=(a,l)=>{me.confirm("\u786E\u8BA4\u662F\u5426\u5220\u9664"+l+"\u7528\u6237\uFF1F","\u786E\u8BA4\u4FE1\u606F",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{_.delete("/api/userGroup/delete?groupId="+n.value+"&id="+a).then(m=>{c.success({message:"\u5220\u9664\u6210\u529F",duration:2e3,showClose:!0}),G()}).catch(m=>{c.error({message:m.response.data,duration:2e3,showClose:!0})})}).catch(()=>{})},Q=()=>{if(h.value=!0,i.value.userId==""){h.value=!1,c.error({message:"\u8BF7\u9009\u62E9\u9879\u76EE\u6210\u5458",duration:2e3,showClose:!0});return}_.post("/api/userGroup/add",i.value).then(a=>{h.value=!1,c.success({message:"\u6DFB\u52A0\u6210\u529F",duration:2e3,showClose:!0}),U()}).catch(a=>{h.value=!1,c.error({message:a.response.data,duration:2e3,showClose:!0})}),i.value.userId="",i.value.role=1},w=d({userId:"",groupId:n.value,role:""}),W=(a,l)=>{w.value.groupId=Number(n.value),w.value.userId=l,w.value.role=a,_.post("/api/userGroup/change",w.value).then(m=>{c.success({message:"\u89D2\u8272\u4FEE\u6539\u6210\u529F",duration:2e3,showClose:!0})}).catch(m=>{c.error({message:m.response.data,duration:2e3,showClose:!0})})},G=()=>{var a="/api/userGroup/all?groupId="+n.value;x.value!=""&&(a+="&keyword="+x.value),_.get(a).then(l=>{M.value=l.data}).catch(l=>{c.error({message:l.response.data,duration:1e3,showClose:!0})})},U=()=>{n.value!=0&&_.get("/api/userGroup/role?groupId="+n.value).then(a=>{D.value=a.data,_.get("/api/userGroup/all?groupId="+n.value).then(l=>{M.value=l.data}).catch(l=>{c.error({message:l.response.data,duration:1e3,showClose:!0})})}).catch(a=>{c.error({message:a.response.data,duration:1e3,showClose:!0})})};return oe(()=>{n.value!=0&&(U(),n.value=Number(T.params.id))}),ne((a,l)=>{n.value=a.params.id,i.value.groupId=Number(n.value),U()}),(a,l)=>{const m=p("el-option"),S=p("el-select"),z=p("el-form-item"),E=p("el-button"),X=p("el-form"),Y=p("el-input"),Z=p("el-icon"),ee=p("el-avatar"),le=p("el-image"),ae=p("el-card"),$=de("loading");return n.value!=0?(s(),r("div",_e,[D.value==0?(s(),r("div",he,[o("div",ge,[fe,ye,be,t(X,{"label-position":H.value,"label-width":"100px",model:i.value,style:{"max-width":"460px"}},{default:u(()=>[t(z,{label:"\u6210\u5458\u540D\u79F0"},{default:u(()=>[t(S,{modelValue:i.value.userId,"onUpdate:modelValue":l[0]||(l[0]=e=>i.value.userId=e),loading:b.value,filterable:"",remote:"","reserve-keyword":!1,"default-first-option":"","remote-show-suffix":"","remote-method":R,placeholder:" ",style:{width:"100%"},"value-key":"name"},{default:u(()=>[j((s(),r("div",xe,[(s(!0),r(I,null,C(N.value,e=>(s(),F(m,{style:{height:"45px"},key:e.id,value:e.id,label:e.name},{default:u(()=>[o("div",we,[o("div",ke,V(e.name),1)])]),_:2},1032,["value","label"]))),128))])),[[$,b.value]])]),_:1},8,["modelValue","loading"])]),_:1}),t(z,{label:"\u89D2\u8272\u6743\u9650"},{default:u(()=>[t(S,{modelValue:i.value.role,"onUpdate:modelValue":l[1]||(l[1]=e=>i.value.role=e),style:{width:"100%"}},{default:u(()=>[(s(),r(I,null,C(P,e=>t(m,{key:e.value,label:e.label,value:e.value,disabled:e.disabled},null,8,["label","value","disabled"])),64))]),_:1},8,["modelValue"])]),_:1}),t(z,null,{default:u(()=>[t(E,{disabled:h.value,style:{float:"left"},onClick:l[2]||(l[2]=e=>Q())},{default:u(()=>[q("\u6DFB\u52A0\u5230\u7528\u6237\u7EC4 ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["label-position","model"])])])):L("",!0),o("div",Ie,[Ce,t(Y,{modelValue:x.value,"onUpdate:modelValue":l[3]||(l[3]=e=>x.value=e),placeholder:"\u641C\u7D22\u4EBA\u5458","prefix-icon":k(A),style:{width:"20%","margin-left":"auto","margin-right":"20px"},onKeydown:re(G,["enter"])},null,8,["modelValue","prefix-icon","onKeydown"]),t(E,{type:"primary",style:{"margin-right":"10px"},onClick:l[4]||(l[4]=e=>G())},{default:u(()=>[t(Z,null,{default:u(()=>[t(k(A))]),_:1}),q(" \xA0\u67E5\u8BE2 ")]),_:1})]),j((s(),r("div",Ve,[(s(!0),r(I,null,C(M.value,(e,te)=>(s(),F(ae,{shadow:"hover",key:te},{default:u(()=>[o("div",Be,[o("div",Me,[t(le,{src:"/api/user/avatar?id="+e.userId,style:{width:"40px",height:"40px"}},{error:u(()=>[t(ee,{src:k(ve)},null,8,["src"])]),_:2},1032,["src"]),o("div",Ne,V(e.name),1)]),D.value==0?(s(),r("div",De,[e.role!==0?(s(),r("div",Ge,[t(S,{modelValue:e.role,"onUpdate:modelValue":v=>e.role=v,size:"small",style:{width:"100%"},onChange:v=>W(v,e.userId)},{default:u(()=>[(s(),r(I,null,C(P,v=>t(m,{key:v.value,label:v.label,value:v.value,disabled:v.disabled},null,8,["label","value","disabled"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])):(s(),r("div",Ue,V(K[e.role]),1)),e.role!==0?(s(),r("div",Se,[t(E,{type:"danger",icon:k(ie),size:"small",onClick:v=>J(e.userId,e.name)},null,8,["icon","onClick"])])):L("",!0)])):(s(),r("div",ze,[o("div",Ee,V(K[e.role]),1)]))])]),_:2},1024))),128))])),[[$,O.value]])])):L("",!0)}}},Pe=se(Le,[["__scopeId","data-v-7995702b"]]);export{Pe as default};
